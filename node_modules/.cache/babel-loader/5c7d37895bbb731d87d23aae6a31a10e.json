{"ast":null,"code":"/* eslint-disable array-callback-return */\nconst inittialState = {\n  basket: [// { id, left, amount, price },\n    // { id, left, amount, price},\n  ],\n  finally: 0,\n  error: null\n};\n\nconst basket = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : inittialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case \"get/basket/pending\":\n      return { ...state,\n        getting: true,\n        error: null\n      };\n\n    case \"get/basket/fulfilled\":\n      const productInBasketSum = action.payload.basket.products.reduce((finallySum, productInBasket) => {\n        action.payload.products.find(product => {\n          if (product._id === productInBasket.id) {\n            finallySum += product.price * productInBasket.amount;\n          }\n        });\n        return finallySum;\n      }, 0);\n      return { ...state,\n        getting: false,\n        basket: [...action.payload.basket.products.map(product => product)],\n        finally: productInBasketSum\n      };\n\n    case \"get/basket/rejected\":\n      return { ...state,\n        getting: false,\n        error: action.error\n      };\n\n    case \"addproduct/inbasket/pending\":\n      return { ...state,\n        productloadInBasket: true,\n        error: null\n      };\n\n    case \"addproduct/inbasket/fulfilled\":\n      const id = action.payload._id;\n      const left = action.payload.left--;\n      const price = action.payload.price;\n      return { ...state,\n        productloadInBasket: false,\n        basket: [...state.basket, {\n          id,\n          left,\n          price,\n          amount: 1\n        }],\n        finally: state.finally + price\n      };\n\n    case \"addproduct/inbasket/rejected\":\n      return { ...state,\n        productloadInBasket: false,\n        error: action.error\n      };\n\n    case \"deleteproduct/frombasket/pending\":\n      return { ...state,\n        productloadInBasket: true,\n        error: null\n      };\n\n    case \"deleteproduct/inbasket/fulfilled\":\n      const productInBasket = state.basket.find(product => product.id === action.payload.id); // console.log(productInBasket2, productInBasket);\n\n      return { ...state,\n        productloadInBasket: false,\n        basket: [...state.basket.filter(product => product.id !== action.payload.id)],\n        finally: state.basket.reduce((finallySum, productPrice) => {\n          if (productPrice.id !== productInBasket.id) {\n            finallySum += productPrice.price * productPrice.amount;\n          }\n\n          return finallySum;\n        }, 0)\n      };\n\n    case \"deleteproduct/inbasket/rejected\":\n      return { ...state,\n        productloadInBasket: false,\n        error: action.error\n      };\n\n    case \"addamount/productinbasket/pending\":\n      return { ...state,\n        productloadInBasket: true,\n        error: null\n      };\n\n    case \"addamount/productinbasket/fulfilled\":\n      const productINC = action.payload.products.find(product => product._id === action.payload.id);\n      return { ...state,\n        productloadInBasket: false,\n        basket: [...state.basket.map(product => {\n          if (product.id === action.payload.id) {\n            if (product.left > 0) {\n              product.left -= 1;\n              product.amount += 1;\n            }\n          }\n\n          return product;\n        })],\n        finally: state.finally + productINC.price\n      };\n\n    case \"addamount/productinbasket/rejected\":\n      return { ...state,\n        productloadInBasket: false,\n        error: action.error\n      };\n\n    case \"removeamount/productinbasket/pending\":\n      return { ...state,\n        productloadInBasket: true,\n        error: null\n      };\n\n    case \"removeamount/productinbasket/fulfilled\":\n      const productDEC = action.payload.products.find(product => product._id === action.payload.id);\n      return { ...state,\n        productloadInBasket: false,\n        basket: [...state.basket.map(product => {\n          if (product.id === action.payload.id) {\n            if (product.amount > 1) {\n              product.left += 1;\n              product.amount -= 1;\n            }\n          }\n\n          return product;\n        })],\n        finally: state.finally - productDEC.price\n      };\n\n    case \"removeamount/productinbasket/rejected\":\n      return { ...state,\n        productloadInBasket: false,\n        error: action.error\n      };\n\n    case \"bye/products/pending\":\n      return { ...state,\n        byeing: true\n      };\n\n    case \"bye/products/fulfilled\":\n      return { ...state,\n        basket: [],\n        finally: 0,\n        byeing: false\n      };\n\n    case \"bye/products/rejected\":\n      return { ...state,\n        byeing: false,\n        error: action.error\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport const getAllProductsInBasket = () => {\n  return async (dispatch, getState) => {\n    const state = getState();\n    dispatch({\n      type: \"get/basket/pending\"\n    });\n\n    try {\n      const res = await fetch(\"http://localhost:4000/basket\", {\n        headers: {\n          \"Content-type\": \"application/json\",\n          Authorization: `Bearer ${state.application.token}`\n        }\n      });\n      const basket = await res.json();\n      dispatch({\n        type: \"get/basket/fulfilled\",\n        payload: {\n          basket,\n          products: state.products.products\n        }\n      });\n    } catch (error) {\n      dispatch({\n        type: \"get/basket/rejected\",\n        error: error\n      });\n    }\n  };\n};\nexport const addProductInBasket = id => {\n  return async (dispatch, getState) => {\n    dispatch({\n      type: \"addproduct/inbasket/pending\"\n    });\n    const state = getState();\n    const token = state.application.token;\n\n    try {\n      const res = await fetch(`http://localhost:4000/addproductinbasket/${id}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const productinBasket = await res.json();\n      dispatch({\n        type: \"addproduct/inbasket/fulfilled\",\n        payload: productinBasket\n      });\n    } catch (error) {\n      dispatch({\n        type: \"addproduct/inbasket/rejected\",\n        error: error\n      });\n    }\n  };\n};\nexport const deleteProductFromBasket = id => {\n  return async (dispatch, getState) => {\n    dispatch({\n      type: \"deleteproduct/frombasket/pending\"\n    });\n    const state = getState();\n    const products = state.products.products;\n    const token = state.application.token;\n\n    try {\n      await fetch(`http://localhost:4000/deleteProductFromBasket/${id}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      });\n      dispatch({\n        type: \"deleteproduct/inbasket/fulfilled\",\n        payload: {\n          products,\n          id\n        }\n      });\n    } catch (error) {\n      dispatch({\n        type: \"deleteproduct/inbasket/rejected\",\n        error: error\n      });\n    }\n  };\n};\nexport const byeProducts = clearOrBye => {\n  return async (dispatch, getState) => {\n    const state = getState();\n    const token = state.application.token;\n    dispatch({\n      type: \"bye/products/pending\"\n    });\n\n    try {\n      await fetch(`http://localhost:4000/${clearOrBye}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Conten-type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      });\n      dispatch({\n        type: \"bye/products/fulfilled\"\n      });\n    } catch (error) {\n      dispatch({\n        type: \"bye/products/rejected\",\n        error: error\n      });\n    }\n  };\n};\nexport const addAmountProductinBasket = id => {\n  return async (dispatch, getState) => {\n    const state = getState();\n    const token = state.application.token;\n    const products = state.products.products;\n    dispatch({\n      type: \"addamount/productinbasket/pending\"\n    });\n\n    try {\n      await fetch(`http://localhost:4000/addAmountProductinBasket/${id}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      });\n      dispatch({\n        type: \"addamount/productinbasket/fulfilled\",\n        payload: {\n          products,\n          id\n        }\n      });\n    } catch (error) {\n      dispatch({\n        type: \"addamount/productinbasket/rejected\",\n        error: error\n      });\n    }\n  };\n};\nexport const removeAmountProductinBasket = id => {\n  return async (dispatch, getState) => {\n    const state = getState();\n    const token = state.application.token;\n    const products = state.products.products;\n    dispatch({\n      type: \"removeamount/productinbasket/pending\"\n    });\n\n    try {\n      await fetch(`http://localhost:4000/removeAmountProductinBasket/${id}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-type\": \"application/json\",\n          Authorization: `Bearer ${token}`\n        }\n      });\n      dispatch({\n        type: \"removeamount/productinbasket/fulfilled\",\n        payload: {\n          id,\n          products\n        }\n      });\n    } catch (error) {\n      dispatch({\n        type: \"removeamount/productinbasket/rejected\",\n        error: error\n      });\n    }\n  };\n};\nexport default basket;","map":{"version":3,"sources":["/Users/islam/intocode/newProductSait/frontForProductSait/my-app/src/redux/features/basket.js"],"names":["inittialState","basket","finally","error","state","action","type","getting","productInBasketSum","payload","products","reduce","finallySum","productInBasket","find","product","_id","id","price","amount","map","productloadInBasket","left","filter","productPrice","productINC","productDEC","byeing","getAllProductsInBasket","dispatch","getState","res","fetch","headers","Authorization","application","token","json","addProductInBasket","method","productinBasket","deleteProductFromBasket","byeProducts","clearOrBye","addAmountProductinBasket","removeAmountProductinBasket"],"mappings":"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","sourcesContent":["/* eslint-disable array-callback-return */\nconst inittialState = {\n  basket: [\n    // { id, left, amount, price },\n    // { id, left, amount, price},\n  ],\n  finally: 0,\n  error: null,\n};\n\nconst basket = (state = inittialState, action) => {\n  switch (action.type) {\n    case \"get/basket/pending\":\n      return {\n        ...state,\n        getting: true,\n        error: null,\n      };\n    case \"get/basket/fulfilled\":\n      const productInBasketSum = action.payload.basket.products.reduce(\n        (finallySum, productInBasket) => {\n          action.payload.products.find((product) => {\n            if (product._id === productInBasket.id) {\n              finallySum += product.price * productInBasket.amount;\n            }\n          });\n          return finallySum;\n        },\n        0\n      );\n      return {\n        ...state,\n        getting: false,\n        basket: [...action.payload.basket.products.map((product) => product)],\n        finally: productInBasketSum,\n      };\n    case \"get/basket/rejected\":\n      return {\n        ...state,\n        getting: false,\n        error: action.error,\n      };\n    case \"addproduct/inbasket/pending\":\n      return {\n        ...state,\n        productloadInBasket: true,\n        error: null,\n      };\n    case \"addproduct/inbasket/fulfilled\":\n      const id = action.payload._id;\n      const left = action.payload.left--;\n      const price = action.payload.price;\n      return {\n        ...state,\n        productloadInBasket: false,\n        basket: [...state.basket, { id, left, price, amount: 1 }],\n        finally: state.finally + price,\n      };\n    case \"addproduct/inbasket/rejected\":\n      return {\n        ...state,\n        productloadInBasket: false,\n        error: action.error,\n      };\n    case \"deleteproduct/frombasket/pending\":\n      return {\n        ...state,\n        productloadInBasket: true,\n        error: null,\n      };\n    case \"deleteproduct/inbasket/fulfilled\":\n      const productInBasket = state.basket.find(\n        (product) => product.id === action.payload.id\n      );\n      // console.log(productInBasket2, productInBasket);\n      return {\n        ...state,\n        productloadInBasket: false,\n        basket: [\n          ...state.basket.filter((product) => product.id !== action.payload.id),\n        ],\n        finally: state.basket.reduce((finallySum, productPrice) => {\n          if (productPrice.id !== productInBasket.id) {\n            finallySum += productPrice.price * productPrice.amount;\n          }\n          return finallySum;\n        }, 0),\n      };\n    case \"deleteproduct/inbasket/rejected\":\n      return {\n        ...state,\n        productloadInBasket: false,\n        error: action.error,\n      };\n    case \"addamount/productinbasket/pending\":\n      return {\n        ...state,\n        productloadInBasket: true,\n        error: null,\n      };\n    case \"addamount/productinbasket/fulfilled\":\n      const productINC = action.payload.products.find(\n        (product) => product._id === action.payload.id\n      );\n      return {\n        ...state,\n        productloadInBasket: false,\n        basket: [\n          ...state.basket.map((product) => {\n            if (product.id === action.payload.id) {\n              if (product.left > 0) {\n                product.left -= 1;\n                product.amount += 1;\n              }\n            }\n            return product;\n          }),\n        ],\n        finally: state.finally + productINC.price,\n      };\n\n    case \"addamount/productinbasket/rejected\":\n      return {\n        ...state,\n        productloadInBasket: false,\n        error: action.error,\n      };\n    case \"removeamount/productinbasket/pending\":\n      return {\n        ...state,\n        productloadInBasket: true,\n        error: null,\n      };\n    case \"removeamount/productinbasket/fulfilled\":\n      const productDEC = action.payload.products.find(\n        (product) => product._id === action.payload.id\n      );\n      return {\n        ...state,\n        productloadInBasket: false,\n        basket: [\n          ...state.basket.map((product) => {\n            if (product.id === action.payload.id) {\n              if (product.amount > 1) {\n                product.left += 1;\n                product.amount -= 1;\n              }\n            }\n            return product;\n          }),\n        ],\n        finally: state.finally - productDEC.price,\n      };\n    case \"removeamount/productinbasket/rejected\":\n      return {\n        ...state,\n        productloadInBasket: false,\n        error: action.error,\n      };\n    case \"bye/products/pending\":\n      return {\n        ...state,\n        byeing: true,\n      };\n    case \"bye/products/fulfilled\":\n      return {\n        ...state,\n        basket: [],\n        finally: 0,\n        byeing: false,\n      };\n    case \"bye/products/rejected\":\n      return {\n        ...state,\n        byeing: false,\n        error: action.error,\n      };\n    default:\n      return state;\n  }\n};\n\nexport const getAllProductsInBasket = () => {\n  return async (dispatch, getState) => {\n    const state = getState();\n    dispatch({ type: \"get/basket/pending\" });\n    try {\n      const res = await fetch(\"http://localhost:4000/basket\", {\n        headers: {\n          \"Content-type\": \"application/json\",\n          Authorization: `Bearer ${state.application.token}`,\n        },\n      });\n      const basket = await res.json();\n      dispatch({\n        type: \"get/basket/fulfilled\",\n        payload: {\n          basket,\n          products: state.products.products,\n        },\n      });\n    } catch (error) {\n      dispatch({ type: \"get/basket/rejected\", error: error });\n    }\n  };\n};\n\nexport const addProductInBasket = (id) => {\n  return async (dispatch, getState) => {\n    dispatch({ type: \"addproduct/inbasket/pending\" });\n    const state = getState();\n    const token = state.application.token;\n    try {\n      const res = await fetch(\n        `http://localhost:4000/addproductinbasket/${id}`,\n        {\n          method: \"PATCH\",\n          headers: {\n            \"Content-type\": \"application/json\",\n            Authorization: `Bearer ${token}`,\n          },\n        }\n      );\n      const productinBasket = await res.json();\n      dispatch({\n        type: \"addproduct/inbasket/fulfilled\",\n        payload: productinBasket,\n      });\n    } catch (error) {\n      dispatch({ type: \"addproduct/inbasket/rejected\", error: error });\n    }\n  };\n};\n\nexport const deleteProductFromBasket = (id) => {\n  return async (dispatch, getState) => {\n    dispatch({ type: \"deleteproduct/frombasket/pending\" });\n    const state = getState();\n    const products = state.products.products;\n    const token = state.application.token;\n\n    try {\n      await fetch(`http://localhost:4000/deleteProductFromBasket/${id}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      dispatch({\n        type: \"deleteproduct/inbasket/fulfilled\",\n        payload: {\n          products,\n          id,\n        },\n      });\n    } catch (error) {\n      dispatch({ type: \"deleteproduct/inbasket/rejected\", error: error });\n    }\n  };\n};\n\nexport const byeProducts = (clearOrBye) => {\n  return async (dispatch, getState) => {\n    const state = getState();\n    const token = state.application.token;\n\n    dispatch({ type: \"bye/products/pending\" });\n    try {\n      await fetch(`http://localhost:4000/${clearOrBye}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Conten-type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      dispatch({ type: \"bye/products/fulfilled\" });\n    } catch (error) {\n      dispatch({ type: \"bye/products/rejected\", error: error });\n    }\n  };\n};\n\nexport const addAmountProductinBasket = (id) => {\n  return async (dispatch, getState) => {\n    const state = getState();\n    const token = state.application.token;\n    const products = state.products.products;\n\n    dispatch({ type: \"addamount/productinbasket/pending\" });\n    try {\n      await fetch(`http://localhost:4000/addAmountProductinBasket/${id}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      dispatch({\n        type: \"addamount/productinbasket/fulfilled\",\n        payload: {\n          products,\n          id,\n        },\n      });\n    } catch (error) {\n      dispatch({ type: \"addamount/productinbasket/rejected\", error: error });\n    }\n  };\n};\n\nexport const removeAmountProductinBasket = (id) => {\n  return async (dispatch, getState) => {\n    const state = getState();\n    const token = state.application.token;\n    const products = state.products.products;\n\n    dispatch({ type: \"removeamount/productinbasket/pending\" });\n    try {\n      await fetch(`http://localhost:4000/removeAmountProductinBasket/${id}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      dispatch({\n        type: \"removeamount/productinbasket/fulfilled\",\n        payload: { id, products },\n      });\n    } catch (error) {\n      dispatch({ type: \"removeamount/productinbasket/rejected\", error: error });\n    }\n  };\n};\n\nexport default basket;\n"]},"metadata":{},"sourceType":"module"}